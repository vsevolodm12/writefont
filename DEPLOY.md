# Локальный деплой бота на Mac

## Быстрый старт

### Запуск бота в фоновом режиме:
```bash
./start_bot.sh
```

### Проверка статуса:
```bash
./status_bot.sh
```

### Остановка бота:
```bash
./stop_bot.sh
```

## Описание скриптов

### start_bot.sh
Запускает бота в фоновом режиме:
- Проверяет виртуальное окружение
- Проверяет, не запущен ли уже бот
- Запускает бота через `nohup`
- Сохраняет PID в `bot.pid`
- Выводит логи в `logs/bot.log` и `logs/bot_output.log`

### stop_bot.sh
Останавливает бота:
- Находит процесс по PID из `bot.pid`
- Отправляет SIGTERM для корректного завершения
- При необходимости принудительно завершает (SIGKILL)
- Удаляет `bot.pid` после остановки

### status_bot.sh
Показывает статус бота:
- Проверяет наличие процесса
- Показывает статистику процесса
- Выводит последние строки логов

## Просмотр логов

### В реальном времени:
```bash
tail -f logs/bot.log
```

### Последние 100 строк:
```bash
tail -n 100 logs/bot.log
```

### Ошибки:
```bash
tail -f logs/bot_output.log
```

## Первый запуск

1. Убедитесь что все настроено:
   ```bash
   python check_ready.py
   ```

2. Если нужно инициализировать БД:
   ```bash
   python database/db_init.py
   ```

3. Запустите бота:
   ```bash
   ./start_bot.sh
   ```

## Управление ботом

После запуска бот работает в фоне. Вы можете:
- Закрыть терминал - бот продолжит работать
- Проверить статус: `./status_bot.sh`
- Остановить: `./stop_bot.sh`

## Решение проблем

**Бот не запускается:**
```bash
# Проверьте логи
tail -n 50 logs/bot.log
tail -n 50 logs/bot_output.log

# Проверьте готовность
python check_ready.py
```

**Бот запущен, но не отвечает:**
```bash
# Проверьте статус
./status_bot.sh

# Проверьте подключение к БД
python database/test_connection.py
```

**Не удается остановить бота:**
```bash
# Найдите процесс
ps aux | grep bot.py

# Убейте процесс вручную
kill -9 <PID>
rm bot.pid
```

## Важно

- **Бот НЕ запускается автоматически** при загрузке Mac
- Для запуска нужно вручную выполнить `./start_bot.sh`
- Все данные (БД, файлы) хранятся локально
- Бот можно в любой момент остановить и запустить заново

